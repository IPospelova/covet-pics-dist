var __awaiter=this&&this.__awaiter||function(t,e,i,r){function n(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r["throw"](t))}catch(t){o(t)}}function u(t){t.done?i(t.value):n(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,n,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(a){if(r)throw new TypeError("Generator is already executing.");while(s&&(s=0,a[0]&&(i=0)),i)try{if(r=1,n&&(o=a[0]&2?n["return"]:a[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;if(n=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;n=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t];n=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||arguments.length===2)for(var r=0,n=e.length,o;r<n;r++){if(o||!(r in e)){if(!o)o=Array.prototype.slice.call(e,0,r);o[r]=e[r]}}return t.concat(o||Array.prototype.slice.call(e))};System.register(["./p-Dn_f1KLP.system.js","./p-E7n2UWjj.system.js","./p-rQpy4tDy.system.js","./p-DR4OkRW0.system.js","./p-wzQyDHTD.system.js","./p-DpE7x1_J.system.js","./p-fJzMrpdR.system.js"],(function(t){"use strict";var e,i,r,n,o,s,a,u,h,c,l,f,_,d,p,v,m,b,w;return{setters:[function(t){e=t.r;i=t.c;r=t.h;n=t.H;o=t.g},function(t){s=t.B;a=t.s;u=t.f},function(t){h=t.c;c=t.a;l=t.p;f=t.b;_=t.s},function(t){d=t.m;p=t.s},function(t){v=t.s},function(t){m=t.g;b=t.s},function(t){w=t.g}],execute:function(){var g="/api/v1/embed/:id";var y="/api/v1/shop/:shop/product/:handle";var O=function(){function t(t,e){this.page=0;this.isLoading=false;this.totalPages=1;this.previewSettings={};this.previewHoverMode=false;this.previewPopupMode=false;this.previewMode=false;this.sortType="";this._customSettings={};this._selectedFilters=[];this._environment="production";if(typeof e==="boolean"){this.previewMode=e}if(typeof t==="string"&&Object.keys(s).includes(t)){this._environment=t}}Object.defineProperty(t.prototype,"baseUrl",{get:function(){return s[this._environment]},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"galleryType",{get:function(){return this.productHandle?"product_gallery":"standard_gallery"},enumerable:false,configurable:true});t.prototype.setCustomSettings=function(t){var e=this;this._customSettings=Object.assign({},t);Object.keys(this._customSettings).forEach((function(t){return e._customSettings[t]===null?delete e._customSettings[t]:e._customSettings[t]}));return this._customSettings};t.prototype.setSelectedFilters=function(t){return this._selectedFilters=__spreadArray([],t,true)};t.prototype.standardGalleryUrl=function(){return g.replace(":id",this.embedId)};t.prototype.productGalleryUrl=function(){return y.replace(":shop",this.shopDomain).replace(":handle",this.productHandle)};t.prototype.galleryUrl=function(){if(this._environment==="testing")return"http://localhost:3000/embed";var t=this.baseUrl;this.productHandle?t+=this.productGalleryUrl():t+=this.standardGalleryUrl();if(this.previewMode)t+="/preview";if(this.sortType!=="")t+="?sort_by=".concat(this.sortType);return t};t.prototype.resetPagination=function(){this.page=0;this.totalPages=1};t.prototype.fetchItems=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,r;return __generator(this,(function(n){switch(n.label){case 0:if(this.isLoading||this.page>=this.totalPages){return[2]}this.isLoading=true;this.page+=1;t=this.galleryUrl();e=[];if(this.page>1){e.push("page=".concat(this.page))}if(this._selectedFilters.length>0){if(this.previewMode){this.previewSettings["filters"]=this._selectedFilters}else{this._selectedFilters.forEach((function(t){return e.push(encodeURIComponent("filters[]")+"="+encodeURIComponent(t))}))}}if(e.length>0){t+="?".concat(e.join("&"))}return[4,fetch(t,this.fetchOptions)];case 1:i=n.sent();if(!i.ok){throw new Error("".concat(i.status))}return[4,i.json()];case 2:r=n.sent();r.items=this.getItemsWithLocaleLinks(r.items);this.data=Object.assign({},r);this.data.settings=Object.assign(Object.assign({},this.data.settings),this._customSettings);if(this.previewSettings["settings"]!==undefined){r.settings=Object.assign(Object.assign(Object.assign({},r.settings),this._customSettings),this.previewSettings["settings"])}else{r.settings=Object.assign(Object.assign({},r.settings),this._customSettings)}this.totalPages=r.total_pages;this.galleryId=r.gallery_id;this.shopId=r.shop_id;this.isLoading=false;return[2,r]}}))}))};t.prototype.getItemsWithLocaleLinks=function(t){var e=function(t){var e=window.location.hostname;var i=t;var r=window.Shopify;if(typeof r!=="undefined"&&r.routes&&r.routes.root&&r.routes.root!=="/"){return i.replace("".concat(e,"/"),"".concat(e).concat(r.routes.root))}return i};t.forEach((function(t){if(t.links&&t.links.length>0){t.links.forEach((function(t){t.link=e(t.link);return t}))}return t}));return t};Object.defineProperty(t.prototype,"fetchOptions",{get:function(){var t=this;var e={};var i={};var r=Object.keys(this.previewSettings);if(this.previewMode){i["method"]="POST";i["headers"]={"Content-Type":"application/json"};if(r.length>0){r.forEach((function(i){var r=i.replace(/^(gallery_embed\[)/,"").replace(/\]$/,"");e[r]=t.previewSettings[i]}));i["body"]=JSON.stringify(e)}}return i},enumerable:false,configurable:true});return t}();var S=[];var x=function(){return S.some((function(t){return t.activeTargets.length>0}))};var k=function(){return S.some((function(t){return t.skippedTargets.length>0}))};var j="ResizeObserver loop completed with undelivered notifications.";var E=function(){var t;if(typeof ErrorEvent==="function"){t=new ErrorEvent("error",{message:j})}else{t=document.createEvent("Event");t.initEvent("error",false,false);t.message=j}window.dispatchEvent(t)};var z;(function(t){t["BORDER_BOX"]="border-box";t["CONTENT_BOX"]="content-box";t["DEVICE_PIXEL_CONTENT_BOX"]="device-pixel-content-box"})(z||(z={}));var A=function(t){return Object.freeze(t)};var F=function(){function t(t,e){this.inlineSize=t;this.blockSize=e;A(this)}return t}();var I=function(){function t(t,e,i,r){this.x=t;this.y=e;this.width=i;this.height=r;this.top=this.y;this.left=this.x;this.bottom=this.top+this.height;this.right=this.left+this.width;return A(this)}t.prototype.toJSON=function(){var t=this,e=t.x,i=t.y,r=t.top,n=t.right,o=t.bottom,s=t.left,a=t.width,u=t.height;return{x:e,y:i,top:r,right:n,bottom:o,left:s,width:a,height:u}};t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)};return t}();var C=function(t){return t instanceof SVGElement&&"getBBox"in t};var P=function(t){if(C(t)){var e=t.getBBox(),i=e.width,r=e.height;return!i&&!r}var n=t,o=n.offsetWidth,s=n.offsetHeight;return!(o||s||t.getClientRects().length)};var R=function(t){var e;if(t instanceof Element){return true}var i=(e=t===null||t===void 0?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(i&&t instanceof i.Element)};var D=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image"){break}case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return true}return false};var T=typeof window!=="undefined"?window:{};var M=new WeakMap;var U=/auto|scroll/;var B=/^tb|vertical/;var H=/msie|trident/i.test(T.navigator&&T.navigator.userAgent);var W=function(t){return parseFloat(t||"0")};var G=function(t,e,i){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=false}return new F((i?e:t)||0,(i?t:e)||0)};var N=A({devicePixelContentBoxSize:G(),borderBoxSize:G(),contentBoxSize:G(),contentRect:new I(0,0,0,0)});var q=function(t,e){if(e===void 0){e=false}if(M.has(t)&&!e){return M.get(t)}if(P(t)){M.set(t,N);return N}var i=getComputedStyle(t);var r=C(t)&&t.ownerSVGElement&&t.getBBox();var n=!H&&i.boxSizing==="border-box";var o=B.test(i.writingMode||"");var s=!r&&U.test(i.overflowY||"");var a=!r&&U.test(i.overflowX||"");var u=r?0:W(i.paddingTop);var h=r?0:W(i.paddingRight);var c=r?0:W(i.paddingBottom);var l=r?0:W(i.paddingLeft);var f=r?0:W(i.borderTopWidth);var _=r?0:W(i.borderRightWidth);var d=r?0:W(i.borderBottomWidth);var p=r?0:W(i.borderLeftWidth);var v=l+h;var m=u+c;var b=p+_;var w=f+d;var g=!a?0:t.offsetHeight-w-t.clientHeight;var y=!s?0:t.offsetWidth-b-t.clientWidth;var O=n?v+b:0;var S=n?m+w:0;var x=r?r.width:W(i.width)-O-y;var k=r?r.height:W(i.height)-S-g;var j=x+v+y+b;var E=k+m+g+w;var z=A({devicePixelContentBoxSize:G(Math.round(x*devicePixelRatio),Math.round(k*devicePixelRatio),o),borderBoxSize:G(j,E,o),contentBoxSize:G(x,k,o),contentRect:new I(l,u,x,k)});M.set(t,z);return z};var L=function(t,e,i){var r=q(t,i),n=r.borderBoxSize,o=r.contentBoxSize,s=r.devicePixelContentBoxSize;switch(e){case z.DEVICE_PIXEL_CONTENT_BOX:return s;case z.BORDER_BOX:return n;default:return o}};var V=function(){function t(t){var e=q(t);this.target=t;this.contentRect=e.contentRect;this.borderBoxSize=A([e.borderBoxSize]);this.contentBoxSize=A([e.contentBoxSize]);this.devicePixelContentBoxSize=A([e.devicePixelContentBoxSize])}return t}();var J=function(t){if(P(t)){return Infinity}var e=0;var i=t.parentNode;while(i){e+=1;i=i.parentNode}return e};var K=function(){var t=Infinity;var e=[];S.forEach((function i(r){if(r.activeTargets.length===0){return}var n=[];r.activeTargets.forEach((function e(i){var r=new V(i.target);var o=J(i.target);n.push(r);i.lastReportedSize=L(i.target,i.observedBox);if(o<t){t=o}}));e.push((function t(){r.callback.call(r.observer,n,r.observer)}));r.activeTargets.splice(0,r.activeTargets.length)}));for(var i=0,r=e;i<r.length;i++){var n=r[i];n()}return t};var Q=function(t){S.forEach((function e(i){i.activeTargets.splice(0,i.activeTargets.length);i.skippedTargets.splice(0,i.skippedTargets.length);i.observationTargets.forEach((function e(r){if(r.isActive()){if(J(r.target)>t){i.activeTargets.push(r)}else{i.skippedTargets.push(r)}}}))}))};var Y=function(){var t=0;Q(t);while(x()){t=K();Q(t)}if(k()){E()}return t>0};var Z;var $=[];var X=function(){return $.splice(0).forEach((function(t){return t()}))};var tt=function(t){if(!Z){var e=0;var i=document.createTextNode("");var r={characterData:true};new MutationObserver((function(){return X()})).observe(i,r);Z=function(){i.textContent="".concat(e?e--:e++)}}$.push(t);Z()};var et=function(t){tt((function e(){requestAnimationFrame(t)}))};var it=0;var rt=function(){return!!it};var nt=250;var ot={attributes:true,characterData:true,childList:true,subtree:true};var st=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"];var at=function(t){if(t===void 0){t=0}return Date.now()+t};var ut=false;var ht=function(){function t(){var t=this;this.stopped=true;this.listener=function(){return t.schedule()}}t.prototype.run=function(t){var e=this;if(t===void 0){t=nt}if(ut){return}ut=true;var i=at(t);et((function(){var r=false;try{r=Y()}finally{ut=false;t=i-at();if(!rt()){return}if(r){e.run(1e3)}else if(t>0){e.run(t)}else{e.start()}}}))};t.prototype.schedule=function(){this.stop();this.run()};t.prototype.observe=function(){var t=this;var e=function(){return t.observer&&t.observer.observe(document.body,ot)};document.body?e():T.addEventListener("DOMContentLoaded",e)};t.prototype.start=function(){var t=this;if(this.stopped){this.stopped=false;this.observer=new MutationObserver(this.listener);this.observe();st.forEach((function(e){return T.addEventListener(e,t.listener,true)}))}};t.prototype.stop=function(){var t=this;if(!this.stopped){this.observer&&this.observer.disconnect();st.forEach((function(e){return T.removeEventListener(e,t.listener,true)}));this.stopped=true}};return t}();var ct=new ht;var lt=function(t){!it&&t>0&&ct.start();it+=t;!it&&ct.stop()};var ft=function(t){return!C(t)&&!D(t)&&getComputedStyle(t).display==="inline"};var _t=function(){function t(t,e){this.target=t;this.observedBox=e||z.CONTENT_BOX;this.lastReportedSize={inlineSize:0,blockSize:0}}t.prototype.isActive=function(){var t=L(this.target,this.observedBox,true);if(ft(this.target)){this.lastReportedSize=t}if(this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize){return true}return false};return t}();var dt=function(){function t(t,e){this.activeTargets=[];this.skippedTargets=[];this.observationTargets=[];this.observer=t;this.callback=e}return t}();var pt=new WeakMap;var vt=function(t,e){for(var i=0;i<t.length;i+=1){if(t[i].target===e){return i}}return-1};var mt=function(){function t(){}t.connect=function(t,e){var i=new dt(t,e);pt.set(t,i)};t.observe=function(t,e,i){var r=pt.get(t);var n=r.observationTargets.length===0;if(vt(r.observationTargets,e)<0){n&&S.push(r);r.observationTargets.push(new _t(e,i&&i.box));lt(1);ct.schedule()}};t.unobserve=function(t,e){var i=pt.get(t);var r=vt(i.observationTargets,e);var n=i.observationTargets.length===1;if(r>=0){n&&S.splice(S.indexOf(i),1);i.observationTargets.splice(r,1);lt(-1)}};t.disconnect=function(t){var e=this;var i=pt.get(t);i.observationTargets.slice().forEach((function(i){return e.unobserve(t,i.target)}));i.activeTargets.splice(0,i.activeTargets.length)};return t}();var bt=function(){function t(t){if(arguments.length===0){throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.")}if(typeof t!=="function"){throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.")}mt.connect(this,t)}t.prototype.observe=function(t,e){if(arguments.length===0){throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.")}if(!R(t)){throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element")}mt.observe(this,t,e)};t.prototype.unobserve=function(t){if(arguments.length===0){throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.")}if(!R(t)){throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element")}mt.unobserve(this,t)};t.prototype.disconnect=function(){mt.disconnect(this)};t.toString=function(){return"function ResizeObserver () { [polyfill code] }"};return t}();var wt=h({name:"widgetId",initialState:{embedId:null,productHandle:null,shopDomain:null,galleryId:null,shopId:null,photoRequestId:null},reducers:{widgetIdUpdated:function(t,e){var i=e.payload,r=i.embedId,n=i.productHandle,o=i.shopDomain,s=i.photoRequestId;t.embedId=r;t.productHandle=n;t.shopDomain=o;t.photoRequestId=s},widgetGalleryIdUpdated:function(t,e){t.galleryId=e.payload},widgetShopIdUpdated:function(t,e){t.shopId=e.payload}}});var gt=wt.actions,yt=gt.widgetIdUpdated,Ot=gt.widgetGalleryIdUpdated,St=gt.widgetShopIdUpdated;var xt=wt.reducer;var kt={production:"https://app.covet.pics",development:"http://localhost:3000",staging:"https://covetstaging.spacesquirrel.net",testing:"http://localhost:3000/testing_db"};var jt="/api/v1/beacons";var Et=h({name:"url",initialState:{baseUrl:"",environment:"",baseBeaconsUrl:""},reducers:{setEnvironment:function(t,e){var i=e.payload;typeof i==="string"&&Object.keys(kt).includes(i)?t.environment=i:t.environment="production";t.baseUrl=kt[t.environment];t.baseBeaconsUrl="".concat(kt[t.environment]).concat(jt,"/");return t}}});var zt=Et.actions.setEnvironment;var At=Et.reducer;var Ft=h({name:"size",initialState:{widgetWidth:320,windowHeight:600,isDesktopScreen:true},reducers:{widgetWidthUpdated:function(t,e){t.widgetWidth=e.payload;t.isDesktopScreen=e.payload>=800},windowHeightUpdated:function(t,e){t.windowHeight=e.payload}}});var It=Ft.actions,Ct=It.widgetWidthUpdated,Pt=It.windowHeightUpdated;var Rt=Ft.reducer;var Dt=h({name:"preview",initialState:{hoverMode:false,popupMode:false,mode:false},reducers:{setPreviewHoverMode:function(t,e){t.hoverMode=e.payload},setPreviewPopupMode:function(t,e){t.popupMode=e.payload},setPreviewMode:function(t,e){t.mode=e.payload}}});var Tt=Dt.actions,Mt=Tt.setPreviewHoverMode,Ut=Tt.setPreviewPopupMode,Bt=Tt.setPreviewMode;var Ht=Dt.reducer;var Wt=h({name:"analytics",initialState:false,reducers:{setAnalytics:function(t,e){t=e.payload;return t}}});var Gt=Wt.actions.setAnalytics;var Nt=Wt.reducer;var qt={add_to_cart_button_caption:"Add to cart",arrow_color_theme:"light",arrow_custom_box_color:"#000000",arrow_custom_color:"#d3d3d3",arrow_graphics_type:"type_1",arrow_size:"standard",arrow_size_custom:48,background_color:"#000000",close_button_color_theme:"dark_btn",close_button_custom_box_color:"#000000",close_button_custom_color:"#d3d3d3",close_button_position:"side",close_button_size:"standard",close_button_type:"btn_type_1",customer_photo_item_label:"Add Your Photo",customer_photo_item_position:null,customer_photo_upload_body:"We would love to see it in action",customer_photo_upload_button_selector:"",customer_photo_upload_complete_body:"Thank you for your awesome photo! You will see it on the site once it’s approved",customer_photo_upload_complete_close_label:"Close",customer_photo_upload_drop_files_label:"Drag & Drop photos here",customer_photo_upload_form_body_placeholder:"Say something about your image",customer_photo_upload_form_email_placeholder:"E-mail",customer_photo_upload_form_legal_message:"",customer_photo_upload_form_name_placeholder:"Nickname",customer_photo_upload_form_send_label:"Send",customer_photo_upload_form_uploading:"Uploading...",customer_photo_upload_title:"Show It off",customer_widget_cover:null,desktop_arrow_position:"middle",direct_add_to_cart:true,display_type:"grid",font_family:"Source Sans Pro",gallery_highlight:false,gallery_highlight_every:0,gallery_highlight_every_start:0,gallery_mobile_photos_per_row:2,gallery_photos_count:0,gallery_photos_per_row:4,header_show_average_rating:true,header_show_breakdown:true,header_show_sort:true,header_type:"header-1",hide_branding:false,hide_social_links:false,highlight_hotspots_layout:"hotspot-tall",highlight_layout:"slider",highlight_products_layout:"layout-1",hotspots:{enabled:false,background_color:"#000000",show_numbers:false,text_color:"#ffffff"},item_reveal_content:"",item_animation_duration:1,item_animation_type:"hover-animation-1",item_hover_background_opacity:80,item_hover_border_color:"#C1ACAC",item_hover_color_from:"#000000",item_hover_color_to:"#000000",item_hover_disabled:false,item_hover_icon:false,item_label_color:"#FFFFFF",item_label_font_size:15,item_label_font_style:"Normal",item_label_text:"SHOP THIS LOOK",item_mobile_padding:0,item_open_link:false,item_padding:1,item_style:"standard",item_without_product_label_text:"SEE MORE",load_more_border_width:4,load_more_button_color:"#000000",load_more_button_style:"btn_style_1",load_more_font_size:14,load_more_font_style:"bold",load_more_padding:6,load_more_text:"MORE",mobile_arrow_color_theme:"mob_light",mobile_arrow_custom_box_color:"#000000",mobile_arrow_custom_color:"#d3d3d3",mobile_arrow_graphics_type:"mob_type_1",mobile_arrow_position:"mob_top",money_format:"{{amount}}",multiple_filter_enabled:false,padding:0,pagination:"button",popup_animation:true,popup_background_color:"#000000",popup_background_opacity:80,popup_buy_button_background_color:"#444444",popup_buy_button_background_hover_color:"#000000",popup_buy_button_text_color:"#FFFFFF",popup_buy_button_text_hover_color:"#000000",popup_custom_link_label:"Visit",popup_disable_modal:false,popup_feed_show_caption:true,popup_feed_show_navigation_arrows:false,popup_feed_show_star_rating:true,popup_feed_sound_on:true,popup_image_size:"responsive",popup_products_button_caption:"Buy Now",popup_products_title:"SHOP THIS LOOK",popup_products_title_disabled:false,popup_style:"standard",popup_buy_button_style:"buy_btn_style_1",popup_products_view_type:"grid_view",price_label_caption:"Price",primary_color:"#222222",secondary_color:"#BFBFBF",select_label_caption:"Select",show_header:false,show_price:true,show_price_in_popup:true,show_review:true,slideshow_autoplay:0,slideshow_arrows_desktop_align:"start",slideshow_arrows_mobile_align:"start",slideshow_arrows_desktop_position:"top",slideshow_arrows_mobile_position:"top",slideshow_scrollbar_desktop_align:"start",slideshow_scrollbar_mobile_align:"start",slideshow_scrollbar_desktop_position:"top",slideshow_scrollbar_mobile_position:"top",slideshow_load_more:true,slideshow_video_auto_play:false,slideshow_mobile_photos_per_row:2,slideshow_photos_per_row:4,slideshow_crop_mode:false,slideshow_style:"regular",slideshow_desktop_pagination_style:"none",slideshow_mobile_pagination_style:"dots",star_color:"#FCD02C",tags_color:"#86848A",tags_active_color:"#302F33",tags_font_size:12,tags_font_weight:"",tags_padding:0,tags_reset_button_text:"",tags_style:"style_1",tags_wrap:"scroll",upload_show_star_rating:true};var Lt=function(t){t._arrowsDesktopType="arrows-".concat(t.arrow_graphics_type.toString().replace("_","-"));t._arrowsDesktopSizeType=t.arrow_size.toString().replace("_arrow","");t._arrowsDesktopPosition=t.desktop_arrow_position.toString().replace("sidebar_","");t._arrowsMobileColorTheme=t.mobile_arrow_color_theme.toString().replace("mob_","");t._arrowsMobilePosition=t.mobile_arrow_position.toString().replace("mob_","");t._arrowsMobileType=t.mobile_arrow_graphics_type.toString().replace("mob_","arrows-").replace("_","-");t._buyButtonStyle=t.popup_buy_button_style.replace("buy_btn_","").replace("_","-");t._closeButtonType=t.close_button_type.toString().split("_").join("-");t._closeButtonСolorTheme="close-button-color-theme-".concat(t.close_button_color_theme.toString().replace("_btn",""));return t};var Vt=h({name:"settings",initialState:Lt(qt),reducers:{setSettings:function(t,e){var i={};Object.keys(e.payload).forEach((function(t){if(e.payload[t]!==undefined){i[t]=e.payload[t]}}));return Lt(Object.assign(Object.assign({},t),i))}}});var Jt=Vt.actions.setSettings;var Kt=Vt.reducer;var Qt=c({analytics:Nt,size:Rt,sort:p,url:At,preview:Ht,popup:l,modals:d,slider:v,widgetId:xt,settings:Kt});function Yt(){var t=f({reducer:Qt});return t}var Zt=":host{--covet-font-family:var(--covet-custom-font-family, var(--covet-internal-font-family)), sans-serif}:host{font-family:var(--covet-font-family);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:block;min-height:var(--covet-widget-min-height)}:host .error-message{text-align:center;border:2px dashed;padding:20px}";var $t=t("covet_pics_widget",function(){function t(t){e(this,t);this.updateUploadWidgetCover=i(this,"updateUploadWidgetCover",7);this.elementResize=i(this,"elementResize",7);this.previewMode=false;this.lazyLoad=false;this.isLoading=true;this.items=[];this.fetchingError=null;this.fontsLoaded=false;this.filters={}}t.prototype.sortUpdatedHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:this.loader.resetPagination();this.loader.sortType=t.detail;return[4,this.loader.fetchItems()];case 1:e=i.sent();if(typeof e!=="undefined"){this.items=[];this.items=__spreadArray([],this.getItemsWithUpload(e.items),true)}return[2]}}))}))};t.prototype.filtersUpdatedHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,r,n,o;var s=this;return __generator(this,(function(a){switch(a.label){case 0:e=t.detail.resetFilters;if(this.appState.preview.mode){delete this.loader.previewSettings["filters"]}i=function(){Object.keys(s.filters).forEach((function(t){return s.filters[t]=false}));s.loader.setSelectedFilters([])};if(e){i()}else{r=t.detail.filter;if(!this.appState.settings.multiple_filter_enabled&&!this.filters[r]){i()}this.filters[r]=!this.filters[r]}n=Object.keys(this.filters).filter((function(t){return s.filters[t]}));this.loader.setSelectedFilters(n);this.loader.resetPagination();return[4,this.loader.fetchItems()];case 1:o=a.sent();if(typeof o!=="undefined"){this.items=[];this.items=__spreadArray([],this.getItemsWithUpload(o.items),true)}return[2]}}))}))};t.prototype.nextPageHandler=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.loader.fetchItems()];case 1:t=e.sent();if(typeof t!=="undefined"){this.items=__spreadArray(__spreadArray([],this.items,true),t.items,true)}return[2]}}))}))};t.prototype.nextPageHandlerFreeflow=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:if(!(t.detail.embedId===this.appState.widgetId.embedId))return[3,2];return[4,this.loader.fetchItems()];case 1:e=i.sent();if(typeof e!=="undefined"){this.items=__spreadArray(__spreadArray([],this.items,true),e.items,true);this.appStore.dispatch(_(this.items))}i.label=2;case 2:return[2]}}))}))};t.prototype.updateUploadWidgetCoverPreview=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.updateUploadWidgetCover.emit({image:t});return[2]}))}))};t.prototype.updatePreviewSettings=function(t,e,i){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){this.removeModals();this.loader.previewHoverMode=e;this.loader.previewPopupMode=i;this.appStore.dispatch(Mt(e));this.appStore.dispatch(Ut(i));this.fontsLoaded=false;this.loader.previewSettings=Object.assign(Object.assign({},this.loader.previewSettings),t);this.loader.resetPagination();this.loadData();return[2]}))}))};t.prototype.componentWillLoad=function(){if(this.lazyLoad){this.setupLazyLoading()}else{this.initApp()}};t.prototype.setupLazyLoading=function(){var t=this;this.el.style.setProperty("--covet-widget-min-height","5px");this.intersectionObserver=this.observeElementVisibility(this.el,(function(){t.initApp();t.widgetResizeObserver();t.el.style.setProperty("--covet-widget-min-height","0")}))};t.prototype.componentDidLoad=function(){if(!this.lazyLoad){this.widgetResizeObserver()}};t.prototype.disconnectedCallback=function(){this.unsubscribe();if(this.resizeObserver){this.resizeObserver.disconnect()}if(this.intersectionObserver){this.intersectionObserver.disconnect()}};t.prototype.observeElementVisibility=function(t,e){var i=new IntersectionObserver((function(r){if(r.length>0&&r[0].isIntersecting){e();i.unobserve(t)}}));i.observe(t);return i};t.prototype.initApp=function(){this.initAppStore();this.setupLoader();this.loadData()};t.prototype.widgetResizeObserver=function(){var t=this;this.resizeObserver=new bt((function(){var e=t.appState.size.windowHeight!==window.innerHeight;if(e){t.appStore.dispatch(Pt(window.innerHeight))}var i=t.appState.size.widgetWidth!==t.el.getBoundingClientRect().width;if(t.isWidgetWrapExist()&&i){t.setWidgetWidth();t.elementResize.emit()}}));if(this.isWidgetWrapExist()){this.resizeObserver.observe(this.el.parentElement)}};t.prototype.initAppStore=function(){var t=this;this.appStore=Yt();var e=m(this.galleryEmbedId,this.shop,this.photoRequestId,this.el);this.appStore.dispatch(yt(e));this.appStore.dispatch(zt(this.environment));this.appStore.dispatch(Bt(this.previewMode));this.appState=this.appStore.getState();this.unsubscribe=this.appStore.subscribe((function(){t.appState=t.appStore.getState()}));this.setWidgetWidth()};t.prototype.setupLoader=function(){var t=window.location;this.loader=new O(this.environment,this.previewMode);if(typeof this.customSettings==="string"){this.loader.setCustomSettings(JSON.parse(this.customSettings))}if(typeof this.galleryEmbedId==="undefined"||this.galleryEmbedId===0){if(this.shopifyProductId!==undefined){this.loader.productHandle="shopify/".concat(this.shopifyProductId)}else if(this.el.getAttribute("data-product")!==null){this.loader.productHandle=this.el.getAttribute("data-product")}else if(t.pathname.indexOf("/products/")!==-1){this.loader.productHandle=t.pathname.match(/\/products\/([a-zA-Z0-9\-\_\%]+)/)[1]}if(this.el.hasAttribute("data-shop")){this.shop=this.el.getAttribute("data-shop")}if(typeof this.shop==="undefined"){this.fetchingError="The Covet.pics gallery embed has not loaded due to a missing Embed ID. Please make sure to fill in the correct Embed ID";this.isLoading=false;return}else{this.loader.shopDomain=this.shop}}else{this.loader.embedId=this.galleryEmbedId}};t.prototype.loadData=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,r,n,o;return __generator(this,(function(s){switch(s.label){case 0:if(this.fetchingError!==null)return[2];this.isLoading=true;s.label=1;case 1:s.trys.push([1,4,,5]);return[4,this.loader.fetchItems()];case 2:t=s.sent();this.appStore.dispatch(Ot(this.loader.galleryId));this.appStore.dispatch(St(this.loader.shopId));if(this.loader.data.analytics){this.appStore.dispatch(Gt(this.loader.data.analytics))}else{this.appStore.dispatch(Gt(false))}if(typeof t==="undefined")return[2,false];this.appStore.dispatch(Jt(t.settings));this.minNumberOfPhotos=t.settings.min_number_of_photos;this.loader.data.settings.display_type==="highlight"?this.items=__spreadArray([],t.items,true):this.items=__spreadArray([],this.getItemsWithUpload(t.items),true);this.hideElementsIfEmpty();if(!this.fontsLoaded){this.loadFont()}if(this.hasEnoughPhotos&&w(this.appState)){e="Covet.pics Gallery";i="Covet.pics Gallery View";r="Covet.pics Gallery View - "+this.galleryEmbedId;a(i,e,r)}if(this.hasEnoughPhotos){b(this.appState,"gallery_view")}n=this;return[4,this.findAndLoadSharedItemId()];case 3:n.sharedItemId=s.sent();this.initFilters();this.isLoading=false;return[2,true];case 4:o=s.sent();if(o.message==="404"){this.fetchingError="The Covet.pics gallery embed has not loaded because the embed does not exist. Please verify that the correct Embed ID is being used"}this.isLoading=false;return[2,this.fetchingError];case 5:return[2]}}))}))};t.prototype.removeModals=function(){var t=["covet-pics-upload","covet-pics-popup","covet-pics-popup-freeflow"];t.forEach((function(t){var e=document.querySelector("".concat(t));if(e!==null){e.remove()}}))};t.prototype.findAndLoadSharedItemId=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(o){switch(o.label){case 0:if(this.loader.previewPopupMode){t=this.items.find((function(t){return t.source!=="upload_widget"}));return[2,e(typeof t!=="undefined"?t.id.toString():"none")]}i=u(this.loader.embedId,this.loader.galleryType);if(i===null)return[2,e("none")];r=this.items.findIndex((function(t){return t.id===parseInt(i)}))!==-1;if(r)return[2,e(i.toString())];return[4,this.loader.fetchItems()];case 1:n=o.sent();if(typeof n==="undefined")return[2,e("none")];this.items=__spreadArray(__spreadArray([],this.items,true),n.items,true);return[2,e(this.findAndLoadSharedItemId())]}}))}))}))]}))}))};t.prototype.setWidgetWidth=function(){var t=this.isWidgetWrapExist()?this.el.getBoundingClientRect().width:320;return this.appStore.dispatch(Ct(t))};t.prototype.isWidgetWrapExist=function(){return this.el.parentElement!==undefined&&this.el.parentElement instanceof HTMLElement};Object.defineProperty(t.prototype,"hasEnoughPhotos",{get:function(){if(this.items.length===0)return false;if(this.minNumberOfPhotos===null)return true;if(this.loader===undefined||this.loader.data===undefined)return false;if(this.loader.data.items!==undefined&&this.loader.data.items.length<this.minNumberOfPhotos&&this.loader.page===1)return false;return true},enumerable:false,configurable:true});t.prototype.initFilters=function(){var t=this;var e=this.loader.previewSettings["filters"];this.loader.data.filters.list.forEach((function(e){return t.filters[e]=false}));if(this.appState.preview.mode&&typeof e!=="undefined"){e.forEach((function(e){return t.filters[e]=true}))}};t.prototype.loadFont=function(){if(this.loader.data.settings.font_family){var t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("href","https://fonts.googleapis.com/css2?family="+this.loader.data.settings.font_family.split(" ").join("+")+":wght@300;400;600;700&display=swap");document.head.appendChild(t)}this.fontsLoaded=true};t.prototype.setWidgetCSSVariables=function(){var t={};if(this.loader.data.settings.font_family&&this.loader.data.settings.font_family!==""){t["--covet-internal-font-family"]="".concat(this.appState.settings.font_family)}return t};t.prototype.getItemsWithUpload=function(t){if(!this.loader.data.settings.customer_photo_item_position)return t;var e=this.loader.data.settings.customer_photo_item_position-1;var i={source:"upload_widget",imageUrl:this.appState.settings.customer_widget_cover!==null?this.appState.settings.customer_widget_cover:undefined};t.splice(e,0,i);return t};t.prototype.renderSliderGallery=function(){return r(n,{style:this.setWidgetCSSVariables(),class:"needsclick"},r("covet-pics-gallery-slider",{items:this.items,"shared-item-id":this.sharedItemId,"slider-style":this.loader.data.settings.slideshow_style,appStore:this.appStore}))};t.prototype.renderGridGallery=function(){var t,e,i;return r(n,{style:this.setWidgetCSSVariables(),class:"needsclick"},r("covet-pics-gallery-grid",{items:this.items,rating:(t=this.loader.data.reviews)===null||t===void 0?void 0:t.rating,"rating-count":(e=this.loader.data.reviews)===null||e===void 0?void 0:e.rating_count,"product-title":this.loader.data.product_title,breakdown:(i=this.loader.data.reviews)===null||i===void 0?void 0:i.breakdown,"filters-enabled":this.loader.data.filters.enabled,"shared-item-id":this.sharedItemId,filters:this.filters,"show-load-more":this.appState.settings.pagination==="button"&&!this.isLoading&&this.loader.totalPages>this.loader.page&&this.items.length>0,appStore:this.appStore}))};t.prototype.renderHighlighted=function(){return r(n,{style:this.setWidgetCSSVariables(),class:"highlighted"},r("covet-pics-highlighted",{numberOfPages:this.loader.data.items.length,items:this.loader.data.items,appStore:this.appStore}))};t.prototype.hideElementsIfEmpty=function(){var t=this.hideElements;if(!t){t=this.loader.data.settings.selector_to_hide}var e=this.loader.data.items;var i=typeof e!=="undefined"&&e.length===0||!this.hasEnoughPhotos;if(i&&t!==""){var r=document.querySelectorAll(t);r.forEach((function(t){return t.style.display="none"}))}};t.prototype.renderUploadStandalone=function(){return r("covet-pics-upload",{standalone:true,appStore:this.appStore})};t.prototype.renderError=function(){return r(n,null,r("p",{class:"error-message"},this.fetchingError))};t.prototype.render=function(){if(!this.isLoading&&this.fetchingError!==null)return this.renderError();if(!this.isLoading&&this.hasEnoughPhotos){var t=this.loader.data.settings.display_type;if(t==="upload-standalone")return this.renderUploadStandalone();if(t==="slider")return this.renderSliderGallery();if(t==="highlight")return this.renderHighlighted();return this.renderGridGallery()}};Object.defineProperty(t.prototype,"el",{get:function(){return o(this)},enumerable:false,configurable:true});return t}());$t.style=Zt}}}));